<Window x:Class="GroupeV.EditProductWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ã‰diteur de Produit"
        MinHeight="600" MinWidth="500"
        Height="780" Width="600"
        Background="Transparent"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        WindowStyle="None"
        AllowsTransparency="True">

    <Border CornerRadius="18" Background="{StaticResource NeuBackgroundBrush}">
        <Border.Effect>
            <DropShadowEffect Color="{StaticResource NeuDarkShadow}" BlurRadius="30" ShadowDepth="8" Direction="315" Opacity="0.2"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- HEADER -->
            <Border Grid.Row="0" Padding="28,20">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock x:Name="HeaderTextBlock" Text="Modifier le Produit"
                               FontFamily="{StaticResource NeuFontFamily}" FontSize="20" FontWeight="Bold"
                               Foreground="{StaticResource NeuTextPrimaryBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Gestion des produits"
                               FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                               Foreground="{StaticResource NeuTextSecondaryBrush}" HorizontalAlignment="Center" Margin="0,3,0,0"/>
                </StackPanel>
            </Border>

            <!-- MAIN CONTENT -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="32,4,32,20">

                    <!-- Status -->
                    <Border Style="{StaticResource NeuCardInset}" Padding="12" Margin="0,0,0,14"
                            Visibility="Collapsed" x:Name="StatusBorder">
                        <TextBlock x:Name="StatusTextBlock" Text="" FontFamily="{StaticResource NeuFontFamily}"
                                   FontSize="12" Foreground="{StaticResource NeuTextPrimaryBrush}"
                                   TextWrapping="Wrap" TextAlignment="Center" FontWeight="SemiBold"/>
                    </Border>

                    <!-- Product ID (edit mode only) -->
                    <Border Style="{StaticResource NeuCardInset}" Padding="10" Margin="0,0,0,14"
                            x:Name="ProductIdBorder" Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ID Produit : " FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                       Foreground="{StaticResource NeuTextSecondaryBrush}"/>
                            <TextBlock x:Name="ProductIdTextBlock" Text="0" FontFamily="{StaticResource NeuMonoFont}"
                                       FontSize="12" Foreground="{StaticResource NeuAccentBrush}" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>

                    <!-- Description -->
                    <TextBlock Text="Description du produit *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                               FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                    <TextBox x:Name="DescriptionTextBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,18"
                             Height="72" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"
                             MaxLength="255"/>

                    <!-- â•â• TYPE DE VENTE â€” 3 cards â•â• -->
                    <TextBlock Text="Type de vente *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                               FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,8"/>
                    <Grid Margin="0,0,0,18">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Achat direct -->
                        <Border Grid.Column="0" x:Name="CardBuy" CornerRadius="12" Padding="10,14"
                                Background="{StaticResource NeuSurfaceBrush}"
                                BorderThickness="2" BorderBrush="{StaticResource NeuDividerBrush}"
                                Cursor="Hand" MouseLeftButtonUp="CardBuy_Click">
                            <Border.Effect>
                                <DropShadowEffect Color="{StaticResource NeuDarkShadow}" BlurRadius="6" ShadowDepth="1" Opacity="0.1"/>
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ›’" FontSize="26" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="CardBuyTitle" Text="Achat direct"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="12" FontWeight="Bold"
                                           Foreground="{StaticResource NeuTextPrimaryBrush}"
                                           HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                <TextBlock Text="Vente immÃ©diate Ã  prix fixe"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="10"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"
                                           HorizontalAlignment="Center" TextAlignment="Center"
                                           TextWrapping="Wrap" Margin="0,3,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- EnchÃ¨re -->
                        <Border Grid.Column="2" x:Name="CardAuction" CornerRadius="12" Padding="10,14"
                                Background="{StaticResource NeuSurfaceBrush}"
                                BorderThickness="2" BorderBrush="{StaticResource NeuDividerBrush}"
                                Cursor="Hand" MouseLeftButtonUp="CardAuction_Click">
                            <Border.Effect>
                                <DropShadowEffect Color="{StaticResource NeuDarkShadow}" BlurRadius="6" ShadowDepth="1" Opacity="0.1"/>
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ”¨" FontSize="26" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="CardAuctionTitle" Text="EnchÃ¨re"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="12" FontWeight="Bold"
                                           Foreground="{StaticResource NeuTextPrimaryBrush}"
                                           HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                <TextBlock Text="Mise aux enchÃ¨res avec temps limite"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="10"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"
                                           HorizontalAlignment="Center" TextAlignment="Center"
                                           TextWrapping="Wrap" Margin="0,3,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Vente groupÃ©e -->
                        <Border Grid.Column="4" x:Name="CardGroup" CornerRadius="12" Padding="10,14"
                                Background="{StaticResource NeuSurfaceBrush}"
                                BorderThickness="2" BorderBrush="{StaticResource NeuDividerBrush}"
                                Cursor="Hand" MouseLeftButtonUp="CardGroup_Click">
                            <Border.Effect>
                                <DropShadowEffect Color="{StaticResource NeuDarkShadow}" BlurRadius="6" ShadowDepth="1" Opacity="0.1"/>
                            </Border.Effect>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ‘¥" FontSize="26" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="CardGroupTitle" Text="Vente groupÃ©e"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="12" FontWeight="Bold"
                                           Foreground="{StaticResource NeuTextPrimaryBrush}"
                                           HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                <TextBlock Text="Vente conditionnÃ©e au nombre d'acheteurs dans un dÃ©lai"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="10"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"
                                           HorizontalAlignment="Center" TextAlignment="Center"
                                           TextWrapping="Wrap" Margin="0,3,0,0"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- â•â• SECTION: ACHAT DIRECT â•â• -->
                    <StackPanel x:Name="SectionBuy">
                        <TextBlock Text="Prix HT (â‚¬) *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="PrixHtBuyBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,8"
                                 MaxLength="15" TextChanged="PrixHtBuy_TextChanged"/>

                        <Border Style="{StaticResource NeuCardInset}" Padding="10,7" Margin="0,0,0,8"
                                HorizontalAlignment="Left" CornerRadius="8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="TVA " FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"/>
                                <TextBlock Text="20,00%" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                           FontWeight="Bold" Foreground="{StaticResource NeuAccentBrush}"/>
                                <TextBlock Text="  (taux dÃ©fini par l'administration)"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>

                        <TextBlock Text="Prix TTC (â‚¬) *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="PrixTtcBuyBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,16"
                                 MaxLength="15" TextChanged="PrixTtcBuy_TextChanged"/>

                        <TextBlock Text="QuantitÃ© disponible" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="QuantityBuyBox" Style="{StaticResource NeuTextBox}" Text="1"
                                 MaxLength="6" Margin="0,0,0,4"/>
                        <TextBlock Text="Nombre d'articles disponibles Ã  la vente"
                                   FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                   Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,18"/>
                    </StackPanel>

                    <!-- â•â• SECTION: ENCHÃˆRE â•â• -->
                    <StackPanel x:Name="SectionAuction" Visibility="Collapsed">
                        <TextBlock Text="Prix de dÃ©part (â‚¬) *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="PrixAuctionBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,16"
                                 MaxLength="15"/>

                        <TextBlock Text="Fin de l'enchÃ¨re *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <Grid Margin="0,0,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="90"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Style="{StaticResource NeuCardInset}" Padding="0" CornerRadius="10">
                                <DatePicker x:Name="AuctionEndDatePicker" BorderThickness="0"
                                            Background="Transparent"
                                            FontFamily="{StaticResource NeuFontFamily}" FontSize="13"
                                            VerticalContentAlignment="Center" Padding="12,0" Height="42"/>
                            </Border>
                            <TextBox Grid.Column="2" x:Name="AuctionEndTimeBox" Style="{StaticResource NeuTextBox}"
                                     Text="23:59" MaxLength="5" Height="42"/>
                        </Grid>
                        <TextBlock Text="L'enchÃ¨re se terminera automatiquement Ã  cette date"
                                   FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                   Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,16"/>

                        <TextBlock Text="QuantitÃ© disponible" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="QuantityAuctionBox" Style="{StaticResource NeuTextBox}" Text="1"
                                 MaxLength="6" Margin="0,0,0,4"/>
                        <TextBlock Text="Nombre d'articles disponibles Ã  la vente"
                                   FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                   Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,18"/>
                    </StackPanel>

                    <!-- â•â• SECTION: VENTE GROUPÃ‰E â•â• -->
                    <StackPanel x:Name="SectionGroup" Visibility="Collapsed">
                        <TextBlock Text="Prix HT (â‚¬) *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="PrixHtGroupBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,8"
                                 MaxLength="15" TextChanged="PrixHtGroup_TextChanged"/>

                        <Border Style="{StaticResource NeuCardInset}" Padding="10,7" Margin="0,0,0,8"
                                HorizontalAlignment="Left" CornerRadius="8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="TVA " FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"/>
                                <TextBlock Text="20,00%" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                           FontWeight="Bold" Foreground="{StaticResource NeuAccentBrush}"/>
                                <TextBlock Text="  (taux dÃ©fini par l'administration)"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"/>
                            </StackPanel>
                        </Border>

                        <TextBlock Text="Prix TTC (â‚¬) *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="PrixTtcGroupBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,16"
                                 MaxLength="15" TextChanged="PrixTtcGroup_TextChanged"/>

                        <TextBlock Text="Nombre d'acheteurs requis *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="GroupBuyersBox" Style="{StaticResource NeuTextBox}" Text="1"
                                 MaxLength="6" Margin="0,0,0,4"/>
                        <TextBlock Text="Le produit ne sera vendu que si ce nombre d'acheteurs est atteint."
                                   FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                   Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,16"/>

                        <TextBlock Text="Date/heure limite *" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <Grid Margin="0,0,0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="90"/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Style="{StaticResource NeuCardInset}" Padding="0" CornerRadius="10">
                                <DatePicker x:Name="GroupDeadlineDatePicker" BorderThickness="0"
                                            Background="Transparent"
                                            FontFamily="{StaticResource NeuFontFamily}" FontSize="13"
                                            VerticalContentAlignment="Center" Padding="12,0" Height="42"/>
                            </Border>
                            <TextBox Grid.Column="2" x:Name="GroupDeadlineTimeBox" Style="{StaticResource NeuTextBox}"
                                     Text="23:59" MaxLength="5" Height="42"/>
                        </Grid>
                        <TextBlock Text="Si le nombre d'acheteurs requis n'est pas atteint Ã  cette date, la vente Ã©choue."
                                   FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                   Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,16"/>

                        <TextBlock Text="QuantitÃ© disponible" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                                   FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                        <TextBox x:Name="QuantityGroupBox" Style="{StaticResource NeuTextBox}" Text="1"
                                 MaxLength="6" Margin="0,0,0,4"/>
                        <TextBlock Text="Nombre d'articles disponibles Ã  la vente"
                                   FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                   Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,18"/>
                    </StackPanel>

                    <!-- CatÃ©gorie -->
                    <TextBlock Text="CatÃ©gorie" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                               FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                    <ComboBox x:Name="CategoryComboBox" Style="{StaticResource NeuComboBox}"
                              DisplayMemberPath="Libelle" SelectedValuePath="IdCategorie" Margin="0,0,0,18"/>

                    <!-- Image -->
                    <TextBlock Text="Image du produit (optionnel)" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                               FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                    <Border x:Name="ImagePreviewBorder" Style="{StaticResource NeuCardInset}"
                            CornerRadius="14" Height="130" Margin="0,0,0,8" ClipToBounds="True"
                            AllowDrop="True" Drop="ImageDrop_Drop" DragOver="ImageDrop_DragOver"
                            Cursor="Hand" MouseLeftButtonUp="ImagePreview_Click">
                        <Grid>
                            <Image x:Name="ImagePreview" Stretch="Uniform"
                                   RenderOptions.BitmapScalingMode="HighQuality"/>
                            <StackPanel x:Name="ImageDropPlaceholder" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ“·" FontSize="28" HorizontalAlignment="Center"/>
                                <TextBlock Text="Glissez-dÃ©posez ou cliquez pour choisir"
                                           FontFamily="{StaticResource NeuFontFamily}" FontSize="11"
                                           Foreground="{StaticResource NeuTextSecondaryBrush}"
                                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    <TextBox x:Name="ImageUrlTextBox" Style="{StaticResource NeuTextBox}"
                             Margin="0,0,0,8" IsReadOnly="True" FontSize="11" MaxLength="255"/>

                    <TextBlock Text="Texte alternatif (optionnel)" FontFamily="{StaticResource NeuFontFamily}" FontSize="12"
                               FontWeight="SemiBold" Foreground="{StaticResource NeuTextSecondaryBrush}" Margin="4,0,0,6"/>
                    <TextBox x:Name="ImageAltTextBox" Style="{StaticResource NeuTextBox}" Margin="0,0,0,18"
                             MaxLength="255"/>

                    <!-- Action Buttons -->
                    <Grid Margin="0,4,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button Grid.Column="0" Content="Annuler" Style="{StaticResource NeuButton}"
                                Click="CancelButton_Click" Height="42" Margin="0,0,5,0"/>
                        <Button Grid.Column="1" x:Name="SaveButton" Content="ðŸ’¾  Enregistrer"
                                Style="{StaticResource NeuButtonAccent}"
                                Click="SaveButton_Click" Height="42" Margin="5,0,0,0"/>
                    </Grid>

                    <!-- Delete (edit mode) -->
                    <Button x:Name="DeleteButton" Content="ðŸ—‘ï¸  Supprimer le produit"
                            Style="{StaticResource NeuButtonDanger}"
                            Click="DeleteButton_Click" Height="38" Margin="0,10,0,0"
                            Visibility="Collapsed"/>
                </StackPanel>
            </ScrollViewer>

            <!-- FOOTER -->
            <Border Grid.Row="2" Padding="24,12">
                <TextBlock x:Name="FooterTextBlock" Text="PrÃªt" FontFamily="{StaticResource NeuMonoFont}" FontSize="11"
                           Foreground="{StaticResource NeuTextSecondaryBrush}" HorizontalAlignment="Center"/>
             </Border>
         </Grid>
     </Border>
 </Window>
